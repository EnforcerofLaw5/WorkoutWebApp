<div *mobxAutorun class="container">
  <div class="card">

    <h2>Workout Details</h2>

    @if (workoutStore.selectedWorkout) {
      <div>
        <p><strong>Name:</strong> {{ workoutStore.selectedWorkout.name }}</p>
        <p><strong>Type:</strong> {{ workoutStore.selectedWorkout.type }}</p>
        <p><strong>Date:</strong> {{ workoutStore.selectedWorkout.date | dfnsFormat: 'MM/dd/yyyy' }}</p>
        <p><strong>Notes:</strong> {{ workoutStore.selectedWorkout.notes }}</p>
        @if (workoutStore.selectedWorkout.exercises.length > 0) {
          <table class="exercise-table">
            <thead>
              <tr>
                <th>Exercise</th>
                <th>Muscle</th>
                <th>Category</th>
                <th>Sets</th>
                <th>Reps</th>
                <th style="width: 100px"></th>
              </tr>
            </thead>
            <tbody>
              @for (ex of workoutStore.selectedWorkout.exercises; track ex) {
                <tr>
                  <td>{{ ex.name }}</td>
                  <td>{{ ex.primaryMuscle }}</td>
                  <td>{{ ex.category }}</td>
                  <td>{{ ex.exerciseSets.length || 0 }}</td>
                  <td>
                    {{ ex.exerciseSets.length > 0 ? ex.exerciseSets[0].repsCompleted : '-' }}
                  </td>
                  <td>
                    <button class="btn btn-danger btn-delete" (click)="deleteExercise(ex.id)">
                      Delete
                    </button>
                  </td>
                </tr>
              }
            </tbody>
          </table>
        }
        @if (workoutStore.selectedWorkout.exercises.length === 0) {
          <p>
            No exercises added yet.
          </p>
        }
        <section class="suggestions">
          <h3>Suggested Workout</h3>
          <button class="btn btn-primary" (click)="getSuggestion()">Generate Suggestions</button>
          @if (suggestedWorkout) {
            <div>
              <h4>{{ suggestedWorkout.name }}</h4>
              <ul>
                @for (ex of suggestedWorkout.exercises; track ex) {
                  <li>
                    {{ ex.name }} â€“ {{ ex.primaryMuscle }}
                  </li>
                }
              </ul>
            </div>
          }
        </section>
        <button class="btn btn-primary mt" routerLink="/workouts">Back</button>
      </div>
    }
  </div>
</div>